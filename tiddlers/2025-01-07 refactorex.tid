created: 20250107063342704
modified: 20251114014141327
published: 20250107072341853
tags: blog $:/plugins/adithyab/tiddlyjam/live
title: 2025-01-07 refactorex
type: text/vnd.tiddlywiki

ä¸º ElixirLang å¼€å‘è€…æ¨èä¸€æ¬¾ VS Code æ’ä»¶ refactorexï¼Œå®ƒé€šè¿‡æ‰©å±• VS Code Refactor åŠŸèƒ½ï¼Œæä¾›äº†å¾ˆå¤š elixir å¸¸ç”¨çš„é‡æ„æ–¹æ³•ã€‚å®ƒå¸®åŠ©æˆ‘å‡å°‘äº†å¾ˆå¤šæ— èŠçš„é”®ç›˜æ•²å‡»ï¼Œä½¿ç”¨å•ä¸€å¿«æ·é”®å°±å¯ä»¥å®ç°è¶…å¤šç±»å‹çš„ Refactorï¼Œé‡æ„å·¥ä½œä»æ¯ç‡¥æ— å‘³å˜å¾—ååˆ†æ„‰æ‚¦ï¼Œæå‡äº†æˆ‘ Coding çš„å¹¸ç¦æ„Ÿï¼Œå¸Œæœ›ä½ ä¹Ÿä¼šå–œæ¬¢ã€‚

åˆ†äº«å‡ ä¸ªæˆ‘è§‰å¾—å¾ˆçˆ½çš„ Refactor

!! 1. ä¸‹åˆ’çº¿æ ‡æ³¨æœªä½¿ç”¨çš„å‚æ•°

[img[https://github.com/gp-pereira/refactorex/raw/main/assets/examples/function/underscore_unused_args.gif?raw=true]]

ä¸‹åˆ’çº¿æ ‡æ³¨æœªä½¿ç”¨çš„å‚æ•°æ˜¯ elixir ç‰¹è‰²ï¼Œå…¶ä»–è¯­è¨€åº”è¯¥ä¹Ÿæœ‰ç±»ä¼¼é£æ ¼ï¼Œæˆ‘ä¸å¤ªç¡®å®šã€‚æˆ‘çŸ¥é“ JavaScript ç¤¾åŒºæ¨èæŠŠæœªä½¿ç”¨çš„å‚æ•°åˆ æ‰ï¼ŒğŸ˜‚


!! 2. çŸ­å‡½æ•°

[img[https://github.com/gp-pereira/refactorex/raw/main/assets/examples/function/collapse_anonymous_function.gif?raw=true]]

ç±»ä¼¼ `&(&1 + &2)` çš„åŒ¿åå‡½æ•°ç¼–å†™æ–¹å¼ä¹Ÿæ˜¯ elixir ç‰¹è‰²ï¼Œå¯ä»¥è®©ä»£ç å˜å¾—éå¸¸ç®€æ´ï¼Œæ˜“è¯»ã€‚å®ƒä¼¼ä¹æœ‰å¦å¤–ä¸€ä¸ªåå­—å« `Pointfree é£æ ¼`ã€‚

å¯¹æ¯”ï¼š

```elixir
# before
items
|> Enum.map(fn item -> 
  item.price * (1- discount_rate)
end)
|> Enum.sum()

# after
items
|> Enum.map(&(&.price * (1- discount_rate)))
|> Enum.sum()
```

æˆ–è®¸æœ‰äººä¼šä¸å–œæ¬¢çŸ­å‡½æ•°ï¼Œä½†æ˜¯æ— æ‰€è°“ï¼Œæˆ‘å¾ˆå–œæ¬¢ ğŸ˜„

!! 3. å¼•å…¥ç®¡é“ ï¼ˆintroduce pipelineï¼‰

[img[https://github.com/gp-pereira/refactorex/raw/main/assets/examples/pipeline/introduce_pipe.gif?raw=true]]

pipeline ä¹Ÿæ˜¯ elixir ç‰¹è‰²ã€‚è¯´å®è¯ï¼Œpipeline æ˜¯æˆ‘å–œæ¬¢ elixir çš„ä¸€ä¸ªéå¸¸é‡è¦çš„åŸå› ï¼Œpipeline ä»£ç å†™èµ·æ¥éå¸¸çˆ½ï¼Œå¯ä»¥å‡å°‘å‡½æ•°åµŒå¥—ï¼Œå¹¶ä¸”å¯ä»¥é¿å…å¤§é‡ä¸´æ—¶å˜é‡ï¼Œä»£ç æ›´æ¸…æ™°ã€‚

å¯¹æ¯”ï¼š

```elixir
# before
Shipping.send_package(Shipping.new_package(items))

# after
items
|> Shipping.new_package()
|> shipping.send_package()
```

!! å°ç»“

ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œæˆ‘åˆ†äº«çš„ Refactor éƒ½æ˜¯æå…· elixir ç‰¹è‰²çš„ã€‚ä½†æ˜¯ä¸ç”¨æ‹…å¿ƒï¼Œå…¶ä»–ç¼–ç¨‹è¯­è¨€å¸¸ç”¨çš„é‡æ„æ–¹æ³• refactorex ä¹Ÿæä¾›ï¼Œå¦‚æå–å‡½æ•°ã€å†…è”å‡½æ•°ã€é‡å‘½åç­‰ç­‰ï¼Œæ›´å¤šå†…å®¹è¯·è‡ªè¡Œé˜…è¯» [[refactorex in GitHub|https://github.com/gp-pereira/refactorex]]


refs

* [[RefactorEx in VS Code Marketplace|https://marketplace.visualstudio.com/items?itemName=gp-pereira.refatorex]]
* [[Pointfree ç¼–ç¨‹é£æ ¼æŒ‡å—|https://www.ruanyifeng.com/blog/2017/03/pointfree.html]]