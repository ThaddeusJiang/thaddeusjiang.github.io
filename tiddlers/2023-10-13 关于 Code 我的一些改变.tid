created: 20231013032714474
modified: 20231013052441803
published: 20231013050102945
tags: blog $:/plugins/adithyab/tiddlyjam/live work
title: 2023-10-13 å…³äº Code æˆ‘çš„ä¸€äº›æ”¹å˜
type: text/vnd.tiddlywiki

æœ¬æ¥æƒ³å†™ã€Šä½¿ç”¨ React.js åæˆ‘æœ‰å“ªäº›æ”¹å˜ï¼Ÿã€‹ï¼Œå†™å®Œåå‘ç°æˆ‘çš„æ”¹å˜ä¸ä»…ä»…æ˜¯ React.js ç›¸å…³ï¼Œè¿˜æœ‰ä¸€äº›ä»£ç å‘¨è¾¹çš„å†…å®¹ã€‚

!! 1. File Structure: æ”¾å¼ƒæŒ‰ä»£ç ç±»å‹ç»„ç»‡ï¼Œé€‰æ‹©æŒ‰ä½¿ç”¨é¢‘åº¦ç»„ç»‡

ä½¿ç”¨ React.js ä¹‹å‰ï¼Œæˆ‘æ˜¯æŒ‰ç…§ä»£ç ç±»å‹è¿›è¡Œç»„ç»‡æ–‡ä»¶ç»“æ„çš„ã€‚HTML æ”¾åœ¨ views æ–‡ä»¶å¤¹ï¼ŒJS æ”¾åœ¨ scripts æ–‡ä»¶å¤¹ï¼ŒCSS æ”¾åœ¨ styles æ–‡ä»¶å¤¹ã€‚æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š

```
â”œâ”€â”€ scripts
â”‚Â Â  â”œâ”€â”€ index.js
â”‚Â Â  â”œâ”€â”€ login.js
â”‚Â Â  â””â”€â”€ settings.js
â”œâ”€â”€ styles
â”‚Â Â  â”œâ”€â”€ index.css
â”‚Â Â  â”œâ”€â”€ login.css
â”‚Â Â  â””â”€â”€ settings.css
â””â”€â”€ views
    â”œâ”€â”€ index.html
    â”œâ”€â”€ login.html
    â””â”€â”€ settings.html
```

ä½¿ç”¨ React.js ä¹‹åï¼Œæˆ‘å¼€å§‹æŒ‰ä»£ç è¢«è°ƒç”¨ã€è¢«ä¿®æ”¹çš„é¢‘åº¦ç»„ç»‡æ–‡ä»¶ç»“æ„ã€‚ç™»å½•é¡µéœ€è¦çš„ HTML JS CSS éƒ½æ”¾åœ¨ login æ–‡ä»¶å¤¹ï¼Œç®¡ç†é¡µéœ€è¦çš„ HTML JS CSS éƒ½æ”¾åœ¨ settings æ–‡ä»¶å¤¹ã€‚æ–‡ä»¶ç»“æ„å¦‚ä¸‹ï¼š

```
â”œâ”€â”€ index
â”‚   â”œâ”€â”€ index.css
â”‚   â”œâ”€â”€ index.js
â”‚   â””â”€â”€ index.jsx
â”œâ”€â”€ login
â”‚   â”œâ”€â”€ login.css
â”‚   â”œâ”€â”€ login.js
â”‚   â””â”€â”€ login.jsx
â””â”€â”€ settings
    â”œâ”€â”€ settings.css
    â”œâ”€â”€ settings.js
    â””â”€â”€ settings.jsx
```

è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š

# æ¯æ¬¡æ–°å¢ features æˆ–è€…ä¿®æ”¹ bugs çš„ diff changesets æ›´é›†ä¸­ï¼›
# åœ¨ç¼–è¾‘å™¨ä¸­è¿›è¡Œæ–‡ä»¶å¤¹è·³è·ƒæ›´å°‘ï¼Œæ‰‹æŒ‡å’Œå¤§è„‘è´Ÿæ‹…æ›´å°ï¼›
# å·²æœ‰åŠŸèƒ½çš„ä¿®æ”¹ã€é‡æ„ã€æ‹†åˆ†ã€åˆ é™¤æ›´ç®€å•ã€‚

<<<.tc-big-quote
ä¼ ç»Ÿçš„ MVC ä¸‰å±‚æ¶æ„é¡¹ç›®ä¹Ÿå¯ä»¥æŒ‰ä»£ç ä½¿ç”¨é¢‘åº¦æ•´ç†æ–‡ä»¶æ¶æ„ã€‚
<<<TJ

old style

```
â”œâ”€â”€ controllers
â”‚   â”œâ”€â”€ index.controller.js
â”‚   â”œâ”€â”€ login.controller.js
â”‚   â””â”€â”€ settings.controller.js
â”œâ”€â”€ services
â”‚   â”œâ”€â”€ index.service.js
â”‚   â”œâ”€â”€ login.service.js
â”‚   â””â”€â”€ settings.service.js
â””â”€â”€ views
    â”œâ”€â”€ index.htm
    â”œâ”€â”€ login.htm
    â””â”€â”€ settings.htm
```

new style

```
â”œâ”€â”€ index
â”‚   â”œâ”€â”€ index.controller.js
â”‚   â”œâ”€â”€ index.htm
â”‚   â””â”€â”€ index.service.js
â”œâ”€â”€ login
â”‚   â”œâ”€â”€ login.controller.js
â”‚   â”œâ”€â”€ login.htm
â”‚   â””â”€â”€ login.service.js
â””â”€â”€ settings
    â”œâ”€â”€ settings.controller.js
    â”œâ”€â”€ settings.htm
    â””â”€â”€ settings.service.js
```


!! 2. ä»£ç é‡å¤åˆ©ç”¨å•ä½ä» class å˜å°çš„ function

ä½¿ç”¨ React.js ä¹‹å‰ï¼Œæˆ‘ä½¿ç”¨ class ç»„ç»‡æ•°æ®å’ŒåŠŸèƒ½ï¼Œproperties å’Œ methods æ”¾åœ¨ class ä¸­ï¼Œå¹¶é€šè¿‡ class ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š

```js
// account.js
export class Account {
  name = "";
  age = 0;

  constructor({ name, age }) {
    Account.validateAccount({ name, age });
    this.name = name;
    this.age = age;
  }

  getAccount() {
    return {
      name: this.name,
      age: this.age,
    };
  }

  setAccount({ name, age }) {
    Account.validateAccount({ name, age });
    this.name = name;
    this.age = age;
  }

  static validateAccount({ name, age }) {
    if (name.length <= 0) {
      throw new Error("Name is required");
    }

    if (age < 0) {
      throw new Error("Age must be greater than 0");
    }
  }

  introduce() {
    return `Hello, my name is ${this.name} and I am ${this.age} years old`;
  }
}

// hello.js
import { Account } from "account.js"

const tj = new Account({ name: "TJ", age: 31 });
tj.introduce()
```

ä½¿ç”¨ React.js ä¹‹åï¼Œæˆ‘ä½¿ç”¨ module ç»„ç»‡æ•°æ®å’ŒåŠŸèƒ½ï¼Œæ•°æ®å°±æ˜¯æœ€åŸºæœ¬çš„å˜é‡ï¼ŒåŠŸèƒ½å°±æ˜¯æœ€åŸºæœ¬çš„å‡½æ•°ï¼Œå®ƒä»¬å¯ä»¥è¢«å•ç‹¬ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š

```js
// account.js
import z from "zod";
export const AccountSchema = z.object({
    name: z.string().min(1),
    age: z.number().min(0),
});

export const introduce = async ({ name, age }) => {
    return `Hello, my name is ${name} and I am ${age} years old`;
};

// hello.js
import { AccountSchema, introduce } from "account.js"

const tj = AccountSchema.parse({ name: "TJ", age: 31 });
introduce(tj)
```

è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š

# plaintext object æ¯” class instance object æ›´å®¹æ˜“ç†è§£ï¼Œæ²¡æœ‰é­”æ³•
# function æ¯” class method æ›´å®¹æ˜“ç®¡ç†ã€æ‹†åˆ†ã€æµ‹è¯•ï¼Œå¯ä»¥é¿å…å†™å‡ºå·¨å‹ä»£ç å—ã€‚
# ä»£ç è¡Œæ•°å°‘ï¼Œé˜…è¯»ä»£ç æ›´è½»æ¾ã€‚

<<<.tc-big-quote
CSS ä»£ç é‡å¤åˆ©ç”¨å•ä½ä¹Ÿä» BEM class å˜å°åˆ° utility class
<<<TJ



!! 3. Coding: æ”¾å¼ƒæ¨¡ç‰ˆæ–‡ä»¶å’Œæ³¨è§£ç­‰éæ ‡å‡†ç‰¹æ€§ï¼Œä½¿ç”¨ç¼–ç¨‹è¯­è¨€çš„æ ‡å‡†ç‰¹æ€§

ä½¿ç”¨ React.js ä¹‹å‰ï¼Œæˆ‘ä¼šä½¿ç”¨ä¸€äº›æ¨¡ç‰ˆæŠ€æœ¯ã€‚ä»£ç å¦‚ä¸‹ï¼š

```html
// settings.vue
<script>
const items = [{ message: 'Foo' }, { message: 'Bar' }]
</script>

<template>
    <h1 class="title">Settings</h1>
    <li v-for="item in items">
      {{ item.message }}
    </li>
</template>

<style>
.title {
  color: red;
  font-weight: bold;
}
</style>
```

ä½¿ç”¨ React.js ä¹‹åï¼š

```js
// settings.jsx
import "./settings.css";

export function Settings() {
  const items = [{ message: "Foo" }, { message: "Bar" }];
  return (
    <div>
      <h1 class="title">Settings</h1>
      <ul>
        {items.map((item) => (
          <li>{item.message}</li>
        ))}
      </ul>
    </div>
  );
}
```

æ²¡æœ‰ç‰¹æ®Šè¯­æ³•ï¼Œæ²¡æœ‰ç‰¹æ®Šæ–‡ä»¶ç±»å‹ï¼Œæ‰€æœ‰éƒ½æ˜¯æ™®é€šçš„ JS ä»£ç ã€‚
import "./settings.css" æ˜¯ normal JS code, .map() ä¹Ÿæ˜¯ normal JS codeã€‚

!!!! ä½¿ç”¨ React.js ä¹‹å‰ï¼Œæˆ‘ä¼šä½¿ç”¨ä¸€äº›åŸºäºæ³¨è§£çš„æ¡†æ¶ã€‚ä»£ç å¦‚ä¸‹ï¼š

```ts
// OcpiListFilter.ts

import { IsDateString, IsInt, IsOptional } from 'class-validator';
import { Type } from 'class-transformer';

export class OcpiListFilter {
  @IsOptional()
  @IsDateString()
  dateFrom: string;

  @IsOptional()
  @IsDateString()
  dateTo: string;

  @IsOptional()
  @IsInt()
  @Type(() => Number)
  offset: number;

  @IsOptional()
  @IsInt()
  @Type(() => Number)
  limit: number;
}

```

ä½¿ç”¨ React.js ä¹‹åï¼š

```js
import z from 'zod';

const OcpiListFilterSchema = z.object({
    dateFrom: z.string().date().optional(),
    dateTo: z.string().date().optional(),
    offset: z.number().int().optional(),
    limit: z.number().int().optional(),
});
```

æ²¡æœ‰æ³¨è§£ï¼Œæ²¡æœ‰é»‘é­”æ³•ï¼Œåªæ˜¯æœ€æ™®é€šå‡½æ•°ï¼ˆfunctionï¼‰ã€‚

!! æ€»ç»“

å…¶å®æ˜¯å¾ˆç®€å•çš„å‡ ä»¶å°äº‹ï¼Œå‡ å¥è¯å°±è¯´æ¸…æ¥šäº†ã€‚ä½†æ˜¯è¦å±•ç¤º before and after çš„ä»£ç ï¼Œå ç”¨äº†å¾ˆå¤§ç¯‡å¹…ï¼ŒğŸ˜‚