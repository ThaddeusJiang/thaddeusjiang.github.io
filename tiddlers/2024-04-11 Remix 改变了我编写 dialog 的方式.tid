created: 20240411084948488
modified: 20240411101003823
published: 20240411100624462
tags: blog $:/plugins/adithyab/tiddlyjam/live
title: 2024-04-11 Remix æ”¹å˜äº†æˆ‘ç¼–å†™ dialog çš„æ–¹å¼
type: text/vnd.tiddlywiki

å…³äº dialogï¼ˆå¯¹è¯æ¡†ï¼‰ï¼Œå›æƒ³ä¸€ä¸‹ï¼Œæˆ‘çš„ä»£ç ç»å†è¿‡å¥½å‡ æ¬¡å˜åŒ–ï¼Œä½¿ç”¨ React ä¹‹å‰ï¼ŒReact åˆçº§é˜¶æ®µï¼Œç›®å‰éƒ¨åˆ†é¡¹ç›®ä½¿ç”¨åŸç”Ÿ HTML éƒ¨åˆ†é¡¹ç›®ä½¿ç”¨ Remix frameworkã€‚

tl;dr

# React ä¹‹å‰ï¼šå‘½ä»¤å¼ï¼Œä¾‹å¦‚ window.alert(message)
# React åˆæœŸï¼šall in å£°æ˜å¼ï¼Œä¾‹å¦‚ï¼š[isOpen, setIsOpen] = useState(true)
# é‡‡ç”¨ Radix UI é˜¶æ®µï¼šå€ŸåŠ© DialogTrigger
# daisyUI ç›¸å…³é¡¹ç›®ï¼š å›å½’ HTML native dialog
# Remix ç›¸å…³é¡¹ç›®ï¼šè®¾è®¡ Modal Route


! React ä¹‹å‰ï¼šå‘½ä»¤å¼

React ä¹‹å‰ä½¿ç”¨è¿‡ jQuery, Ext JS, pure JS ç¼–å†™ UIï¼Œä¸€èˆ¬ä½¿ç”¨å‘½ä»¤å¼ç¼–å†™ dialog UIã€‚

```js
// jQuery code
$("#boring").click(function() {
  $.dialog({
    "body": "jQueryScript.net!",
    "title": "jQuery Dialog Plugin Demo",
    "show": true
  });
});

// pure JS
window.alert("hello world")

// sweetalert2
Swal.fire({
  title: "Good job!",
  text: "You clicked the button!",
  icon: "success"
});
```

! React åˆæœŸï¼šall in å£°æ˜å¼

åˆšå¼€å§‹ä½¿ç”¨ React æ—¶ï¼Œå‡ ä¹éƒ½æœ‰ä»£ç éƒ½æ˜¯å£°æ˜å¼çš„ï¼Œä¸€èˆ¬å¦‚ä¸‹ï¼š

```jsx
  let [isOpen, setIsOpen] = useState(true)

  function closeModal() {
    setIsOpen(false)
  }

  function openModal() {
    setIsOpen(true)
  }


  return (
    <>
      <button onClick={openModal}>open</button>
      <Dialog open={isOpen} onClose={closeModal} >
        {* ... *}
      </Dialog>
    </>
  ) 
```

ä¸è¿‡è¿™ç§å†™æ³•æœ‰å¾ˆå¤šé—®é¢˜ï¼š

# å¦‚æœåªæ˜¯æƒ³å®ç°ç±»ä¼¼ alert çš„æé†’åŠŸèƒ½ï¼ŒuseState ä¸€å¥—ä¸‹æ¥ï¼Œæ— ç”¨ä»£ç çˆ†ç‚¸
# æœ‰æ—¶éœ€è¦åœ¨ API request è¿‡ç¨‹ä¸­å¤„ç† dialogï¼Œä½†æ˜¯ dialog æ˜¾ç¤ºä¸å¦è¢«ç»‘å®šåœ¨ UI ä¸­ï¼Œ ä¸åˆ©äºä»£ç æ‹†åˆ†ã€‚
## æ ¹æ® API request ç»“æœå¤„ç† dialog ä¹Ÿéœ€è¦å†™ä¸€å † if-else 

! é‡‡ç”¨ Radix UI é˜¶æ®µï¼šå€ŸåŠ© DialogTrigger 

```jsx
<AlertDialog>
      <AlertDialogTrigger asChild>
        <Button variant="outline">Show Dialog</Button>
      </AlertDialogTrigger>
      <AlertDialogContent>
      {* ... *}
      </AlertDialogContent>
</AlertDialog>
```

ä½¿ç”¨ä¸€ä¸ª AlertDialogTrigger å¯ä»¥é¿å… useState çˆ†ç‚¸ï¼Œç®—æ˜¯ä¸€ç‚¹ç‚¹æ”¹å–„ğŸ¤

! daisyUI ç›¸å…³é¡¹ç›®ï¼š å›å½’ HTML native dialog

```html

<dialog id="my_modal_2" className="modal">
  <div className="modal-box">
    <h3 className="font-bold text-lg">Hello!</h3>
    <p className="py-4">Press ESC key or click outside to close</p>
  </div>
  <form method="dialog" className="modal-backdrop">
    <button>close</button>
  </form>
</dialog>

// close dialog
document.getElementById('my_modal_2').showModal()
```

è¿™ç§æ–¹å¼ä¸ä»…é¿å…äº† useState çˆ†ç‚¸ï¼Œåˆå¯ä»¥åœ¨ä»»æ„æ—¶æœºæ“ä½œ dialogã€‚å¾ˆæ£’ã€‚

ç¼ºç‚¹å°±æ˜¯åœ¨ React é¡¹ç›®ä¸­éœ€è¦ä¸€ä¸ª useRef é…åˆã€‚

```jsx
  const dialogRef = useRef<HTMLDialogElement>(null);

  function open() {
    dialogRef.current?.showModal();
  }

  <dialog ref={dialogRef} className="modal">
    {* ... *}
  </dialog>
```

! Remix ç›¸å…³é¡¹ç›®ï¼šè®¾è®¡ Modal Route

åœ¨éœ€è¦ä½¿ç”¨ Modal çš„é¡µé¢ä¸­åŸ‹ä¸‹ä¸€ä¸ª `<Outlet />`ï¼Œç„¶åå®ç°ä¸€ä¸ª Modal Route å¦‚ä¸‹ï¼š

```jsx
// members.$id.tsx
<Link to={"disable"}>disable</Link>

// members.$id.disable.tsx
export async function action() {
  // your code
  
  return redirect("/members/${id}")
}

export default function MemberDisableRoute() {
    const navigate = useNavigate()
    return (
        <dialog id={props.title} className="modal modal-open">
            <div className="modal-box">
                <h3 className="font-bold text-lg">Are you sure?</h3>
                <div className="modal-action">
                    <button className="btn" onClick={() => navigate(-1)}>Cancel</button>
                    <Form method="POST">
                        <input name="id" value="id" hidden />
                        <button className="btn">Yes</button>
                    </Form>
                </div>
            </div>
        </dialog>
    );
}
```

ä¸ä»…æ²¡æœ‰ useState æ•°é‡çˆ†ç‚¸ï¼Œä¹Ÿä¸éœ€è¦æ‰‹å·¥ç»´æŠ¤ dialog çŠ¶æ€ã€‚

å…¶ä»–ä¼˜ç‚¹ï¼š

# æ›´åˆç†çš„æ‹†åˆ†ä¸šåŠ¡é€»è¾‘ï¼Œdisable UI å’Œ API å’Œ member detail å®Œå…¨éš”ç¦»ï¼Œæ›´å®¹æ˜“æµ‹è¯•ã€‚
# æ›´å®¹æ˜“å¤„ç† page çŠ¶æ€ã€‚ä¾‹å¦‚å¤šä¸ªè¡¨å•çš„æäº¤çŠ¶æ€ï¼Œä»¥å‰å¸¸å¸¸ä¼šå‡ºç° form1.submitting || form2.submitting çš„é—®é¢˜ï¼Œç°åœ¨åªéœ€è¦è¿›è¡Œé¡µé¢è·³è½¬å³å¯ã€‚
# æ›´å®¹æ˜“å¤„ç†å¤šçº§å¼¹çª—ã€‚åªéœ€è¦ç®€å•é‡å¤ Outlet å³å¯ï¼Œé¿å…äº†å¤šå±‚åµŒå¥—ã€‚

ç¼ºç‚¹ï¼š

* æ¡†æ¶ä¾èµ–ã€‚è¿™æ˜¯ Remix Nested Routes å‰æä¸‹çš„å®ç°æ–¹æ¡ˆï¼Œä¸æ˜¯ Web Standardsã€‚


èƒŒæ™¯èµ„æ–™ï¼š

* https://www.jqueryscript.net/demo/Simple-jQuery-Modal-Dialog-Box-Plugin-Dialog/
* https://sweetalert2.github.io/
* https://www.radix-ui.com/primitives/docs/components/alert-dialog
* https://daisyui.com/components/modal/
* https://remix.run/docs/en/main/file-conventions/routes#nested-routes
